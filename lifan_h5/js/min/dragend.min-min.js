!function(t){"use strict";function i(t){function i(){}function n(){return!1}function o(t,i){var e,s;for(e in i)if(i.hasOwnProperty(e)){switch(s=i[e],e){case"height":case"width":case"marginLeft":case"marginTop":s+="px"}t.style[e]=s}return t}function r(t,i){var e;for(e in i)t[e]=i[e];return t}function a(t,i){return function(){return t.apply(i,Array.prototype.slice.call(arguments))}}function h(i,e){var s;return s=t?t(e).find("."+i):Array.prototype.slice.call(e.getElementsByClassName(i))}function c(i,e,s,n,r){var a={};a[e]=s,t?t(i).animate(a,n,r):o(i,a)}function l(t){var i=t.touches,e=i&&i.length?i:t.changedTouches;return{x:f?e[0].pageX:t.pageX,y:f?e[0].pageY:t.pageY}}function g(t,i){var s=r({},u);this.settings=r(s,i),this.container=t,this.pageContainer=e.createElement("div"),this.scrollBorder={x:0,y:0},this.page=0,this.preventScroll=!1,this.pageCssProperties={margin:0},this._onStart=a(this._onStart,this),this._onMove=a(this._onMove,this),this._onEnd=a(this._onEnd,this),this._onKeydown=a(this._onKeydown,this),this._sizePages=a(this._sizePages,this),this._afterScrollTransform=a(this._afterScrollTransform,this),this.pageContainer.innerHTML=t.cloneNode(!0).innerHTML,t.innerHTML="",t.appendChild(this.pageContainer),this._scroll=C?this._scrollWithTransform:this._scrollWithoutTransform,this._animateScroll=C?this._animateScrollWithTransform:this._animateScrollWithoutTransform,o(t,b),setTimeout(a(function(){this.updateInstance(i),this.settings.preventDrag||this._observe(),this.settings.afterInitialize.call(this)},this),10)}function d(i,e,s){t?t(i).on(e,s):i.addEventListener(e,s,!1)}function p(i,e,s){t?t(i).off(e,s):i.removeEventListener(e,s,!1)}var u={pageClass:"dragend-page",direction:"horizontal",minDragDistance:"40",onSwipeStart:i,onSwipeEnd:i,onDragStart:i,onDrag:i,onDragEnd:i,afterInitialize:i,keyboardNavigation:!1,stopPropagation:!1,itemsInPage:1,scribe:0,borderBetweenPages:0,duration:300,preventDrag:!1},f="ontouchstart"in s,m=f?"touchstart":"mousedown",v=f?"touchmove":"mousemove",_=f?"touchend":"mouseup",w={37:"left",38:"up",39:"right",40:"down"},y={pages:"No pages found"},b={overflow:"hidden",padding:0},P=function(){var t=e.createElement("div"),i="Khtml Ms O Moz Webkit".split(" "),s=i.length;return function(e){if(e in t.style)return!0;for(e=e.replace(/^[a-z]/,function(t){return t.toUpperCase()});s--;)if(i[s]+e in t.style)return!0;return!1}}(),C=P("transform");return r(g.prototype,{_checkOverscroll:function(t,i,e){var s={x:i,y:e,overscroll:!0};switch(t){case"right":if(!this.scrollBorder.x)return s.x=Math.round((i-this.scrollBorder.x)/5),s;break;case"left":if((this.pagesCount-1)*this.pageDimentions.width<=this.scrollBorder.x)return s.x=Math.round(-((Math.ceil(this.pagesCount)-1)*(this.pageDimentions.width+this.settings.borderBetweenPages))+i/5),s;break;case"down":if(!this.scrollBorder.y)return s.y=Math.round((e-this.scrollBorder.y)/5),s;break;case"up":if((this.pagesCount-1)*this.pageDimentions.height<=this.scrollBorder.y)return s.y=Math.round(-((Math.ceil(this.pagesCount)-1)*(this.pageDimentions.height+this.settings.borderBetweenPages))+e/5),s}return{x:i-this.scrollBorder.x,y:e-this.scrollBorder.y,overscroll:!1}},_observe:function(){d(this.container,m,this._onStart),this.container.onselectstart=n,this.container.ondragstart=n,this.settings.keyboardNavigation&&d(e.body,"keydown",this._onKeydown),d(s,"resize",this._sizePages)},_onStart:function(t){t=t.originalEvent||t,this.settings.stopPropagation&&t.stopPropagation(),d(e.body,v,this._onMove),d(e.body,_,this._onEnd),this.startCoords=l(t),this.settings.onDragStart.call(this,t)},_onMove:function(t){if(t=t.originalEvent||t,!(t.touches&&t.touches.length>1||t.scale&&1!==t.scale)){t.preventDefault(),this.settings.stopPropagation&&t.stopPropagation();var i=this._parseEvent(t),e=this._checkOverscroll(i.direction,-i.distanceX,-i.distanceY);this.settings.onDrag.call(this,this.activeElement,i,e.overscroll,t),this.preventScroll||this._scroll(e)}},_onEnd:function(t){t=t.originalEvent||t,this.settings.stopPropagation&&t.stopPropagation();var i=this._parseEvent(t);this.startCoords={x:0,y:0},Math.abs(i.distanceX)>this.settings.minDragDistance||Math.abs(i.distanceY)>this.settings.minDragDistance?this.swipe(i.direction):(i.distanceX>0||i.distanceX>0)&&this._scrollToPage(),this.settings.onDragEnd.call(this,this.container,this.activeElement,this.page,t),p(e.body,v,this._onMove),p(e.body,_,this._onEnd)},_parseEvent:function(t){var i=l(t),e=this.startCoords.x-i.x,s=this.startCoords.y-i.y;return this._addDistanceValues(e,s)},_addDistanceValues:function(t,i){var e={distanceX:0,distanceY:0};return"horizontal"===this.settings.direction?(e.distanceX=t,e.direction=t>0?"left":"right"):(e.distanceY=i,e.direction=i>0?"up":"down"),e},_onKeydown:function(t){var i=w[t.keyCode];i&&this._scrollToPage(i)},_setHorizontalContainerCssValues:function(){r(this.pageCssProperties,{cssFloat:"left",overflowY:"auto",overflowX:"hidden",padding:0,display:"block"}),o(this.pageContainer,{overflow:"hidden",width:(this.pageDimentions.width+this.settings.borderBetweenPages)*this.pagesCount,boxSizing:"content-box","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3,margin:0,padding:0})},_setVerticalContainerCssValues:function(){r(this.pageCssProperties,{overflow:"hidden",padding:0,display:"block"}),o(this.pageContainer,{"padding-bottom":this.settings.scribe,boxSizing:"content-box","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3,margin:0})},setContainerCssValues:function(){"horizontal"===this.settings.direction?this._setHorizontalContainerCssValues():this._setVerticalContainerCssValues()},_setPageDimentions:function(){var t=this.container.offsetWidth,i=this.container.offsetHeight;"horizontal"===this.settings.direction?t-=parseInt(this.settings.scribe,10):i-=parseInt(this.settings.scribe,10),this.pageDimentions={width:t,height:i}},_sizePages:function(){var t=this.pages.length;this._setPageDimentions(),this.setContainerCssValues(),"horizontal"===this.settings.direction?r(this.pageCssProperties,{height:this.pageDimentions.height,width:this.pageDimentions.width/this.settings.itemsInPage}):r(this.pageCssProperties,{height:this.pageDimentions.height/this.settings.itemsInPage,width:this.pageDimentions.width});for(var i=0;t>i;i++)o(this.pages[i],this.pageCssProperties);this._jumpToPage("page",this.page)},_calcNewPage:function(t,i){var e=this.settings.borderBetweenPages,s=this.pageDimentions.height,n=this.pageDimentions.width,o=this.page;switch(t){case"up":o<this.pagesCount-1&&(this.scrollBorder.y=this.scrollBorder.y+s+e,this.page++);break;case"down":o>0&&(this.scrollBorder.y=this.scrollBorder.y-s-e,this.page--);break;case"left":o<this.pagesCount-1&&(this.scrollBorder.x=this.scrollBorder.x+n+e,this.page++);break;case"right":o>0&&(this.scrollBorder.x=this.scrollBorder.x-n-e,this.page--);break;case"page":switch(this.settings.direction){case"horizontal":this.scrollBorder.x=(n+e)*i;break;case"vertical":this.scrollBorder.y=(s+e)*i}this.page=i;break;default:this.scrollBorder.y=0,this.scrollBorder.x=0,this.page=0}},_onSwipeEnd:function(){this.preventScroll=!1,this.activeElement=this.pages[this.page*this.settings.itemsInPage],this.settings.onSwipeEnd.call(this,this.container,this.activeElement,this.page)},_jumpToPage:function(t,i){t&&this._calcNewPage(t,i),this._scroll({x:-this.scrollBorder.x,y:-this.scrollBorder.y})},_scrollToPage:function(t,i){this.preventScroll=!0,t&&this._calcNewPage(t,i),this._animateScroll()},_scrollWithTransform:function(t){var i="horizontal"===this.settings.direction?"translateX("+t.x+"px)":"translateY("+t.y+"px)";o(this.pageContainer,{"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i})},_animateScrollWithTransform:function(){var t="transform "+this.settings.duration+"ms ease-out",i=(this.container,this._afterScrollTransform);o(this.pageContainer,{"-webkit-transition":"-webkit-"+t,"-moz-transition":"-moz-"+t,"-ms-transition":"-ms-"+t,"-o-transition":"-o-"+t,transition:t}),this._scroll({x:-this.scrollBorder.x,y:-this.scrollBorder.y}),d(this.container,"webkitTransitionEnd",i),d(this.container,"oTransitionEnd",i),d(this.container,"transitionend",i),d(this.container,"transitionEnd",i)},_afterScrollTransform:function(){var t=this.container,i=this._afterScrollTransform;this._onSwipeEnd(),p(t,"webkitTransitionEnd",i),p(t,"oTransitionEnd",i),p(t,"transitionend",i),p(t,"transitionEnd",i),o(this.pageContainer,{"-webkit-transition":"","-moz-transition":"","-ms-transition":"","-o-transition":"",transition:""})},_scrollWithoutTransform:function(t){var i="horizontal"===this.settings.direction?{marginLeft:t.x}:{marginTop:t.y};o(this.pageContainer,i)},_animateScrollWithoutTransform:function(){var t="horizontal"===this.settings.direction?"marginLeft":"marginTop",i="horizontal"===this.settings.direction?-this.scrollBorder.x:-this.scrollBorder.y;c(this.pageContainer,t,i,this.settings.duration,a(this._onSwipeEnd,this))},swipe:function(t){this.settings.onSwipeStart.call(this,this.container,this.activeElement,this.page),this._scrollToPage(t)},updateInstance:function(t){if(t=t||{},"object"==typeof t&&r(this.settings,t),this.pages=h(this.settings.pageClass,this.pageContainer),!this.pages.length)throw new Error(y.pages);this.pagesCount=this.pages.length/this.settings.itemsInPage,this.activeElement=this.pages[this.page*this.settings.itemsInPage],this._sizePages(),this.settings.jumpToPage&&(this.jumpToPage(t.jumpToPage),delete this.settings.jumpToPage),this.settings.scrollToPage&&(this.scrollToPage(this.settings.scrollToPage),delete this.settings.scrollToPage)},destroy:function(){var t=this.container;p(t,m),p(t,v),p(t,_),p(e.body,"keydown",this._onKeydown),p(s,"resize",this._sizePages),t.removeAttribute("style");for(var i=0;i<this.pages.length;i++)this.pages[i].removeAttribute("style");t.innerHTML=this.pageContainer.innerHTML},scrollToPage:function(t){this._scrollToPage("page",t-1)},jumpToPage:function(t){this._jumpToPage("page",t-1)}}),t&&(t.fn.dragend=function(i){return i=i||{},this.each(function(){var e=t(this).data("dragend");e?e.updateInstance(i):(e=new g(this,i),t(this).data("dragend",e)),"string"==typeof i&&e.swipe(i)}),this}),g}var e=document,s=t;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return i(s.jQuery||s.Zepto)}):s.Dragend=i(s.jQuery||s.Zepto)}(window);