"use strict";!function(){var n=null,t=0,i,e,a,o=$(".b1"),s=$("#file"),d=$("#form"),f=$(".page0"),u=$(".page1"),p=$(".page2"),r=$(".page3"),h=$(".page4"),c=$(".page5"),l=function(){var n=new CROP;n.init({container:".crop",image:"images/1.jpg",width:300,height:300,mask:!1,zoom:{steps:.01,min:1,max:5}}),g(),C()},g=function(){-1!=navigator.userAgent.indexOf("LeSportsAPP")?(f.hide(),u.show(),u.find(".android-modal").show()):$.ajax({url:"http://sso.le.com/open/checklogin",type:"GET",dataType:"jsonp",jsonp:"jsonp",success:function(t){0===t.status?(u.find(".b1").show(),f.hide(),u.show()):(n=t.uid,$.ajax({url:"http://u.api.lesports.com/user/v1/tvpay/vipinfo",type:"GET",data:{caller:1001,userid:n,_method:"POST",terminal:141003,from:"center"},success:function(t){t.data.isSportVip?$.ajax({url:"check_info.php",type:"GET",data:{user_id:n},success:function(n){n.length>2?u.find(".tip1").show():u.find(".b1").show(),f.hide(),u.show()}}):(u.find(".b2").show(),u.find(".tip2").show(),f.hide(),u.show())}}))}})},m=function(){},v=function(){n?(u.hide(),p.show()):u.find(".modal").show()},w=function(){var n=p.find("input").eq(0).val(),t=p.find("input").eq(1).val();if(n.length||t.length)if(n.length&&t.length)alert("中英文名仅能选择一个进行填写");else if(n.length){var i=/^[\u4E00-\u9FA5]+$/;i.test(n)?(e=n,p.hide(),r.show()):alert("出现非中文字符")}else{var i=/^[0-9a-zA-Z]*$/g;i.test(t)?(e=t,p.hide(),r.show()):alert("出现非英文字符")}else alert("请填写完整姓名")},b=function(i){a=(new Date).getTime(),$("#id").val(n),$("#name").val(e),$("#time").val(a),r.find(".p2").show(),r.find(".p1").hide(),$.ajax({url:"upload_file.php",type:"POST",cache:!1,data:new FormData($("#form")[0]),processData:!1,contentType:!1,success:function(i){r.find(".p1").attr("src",i).show(),r.find(".p2").hide(),h.find(".card").attr("src","images/upload/"+n+"_"+a+"_card.png"),t=1}})},q=function(){$.ajax({url:"handleimage.php?media_id="+i,type:"GET",success:function(n){r.find(".p1").attr("src","images/upload/"+i+"_"+a+".jpg"),t=1},error:function(n){}})},_=function(){t?(r.hide(),h.show(),h.find(".thumb").attr("src","images/upload/"+i+".jpg"),h.find(".t1").text(p.find("input").eq(0).val()),h.find(".t2").text(p.find("input").eq(1).val())):alert("请上传图片")},j=function(){r.hide(),p.show()},y=function(){h.find("input").eq(0).val().length&&h.find("input").eq(1).val().length&&h.find("input").eq(2).val().length?$.ajax({url:"add_info.php",type:"POST",data:{user_id:n,name_chinese:p.find("input").eq(0).val(),name_english:p.find("input").eq(1).val(),name:h.find("input").eq(0).val(),phone:h.find("input").eq(2).val(),address:h.find("input").eq(1).val()},success:function(n){h.hide(),c.show()}}):alert("请完整填写收件信息")},x=function(){h.find("input").val("")},T=function(){c.find(".share").show()},P=function(){return!1},E=function(){u.find(".preview-modal").show()},O=function(){u.find(".preview-modal").hide()},S=function(){u.find(".qa-modal").show()},k=function(){u.find(".qa-modal").hide()},A=function(){var n=$(this);n.val().length?n.parent().siblings().find("input").prop("disabled",!0).addClass("grey-input"):n.parent().siblings().find("input").prop("disabled",!1).removeClass("grey-input")},G=function(){r.find(".p1").attr("src","images/p1.png"),h.find(".card").attr("src",""),h.hide(),r.show()},C=function(){o.on("touchstart",v),u.find(".btns .pre_btn").on("touchstart",E),u.find(".btns .qa").on("touchstart",S),u.find(".close").on("touchstart",k),u.find(".pre1").on("touchstart",O),p.find("input").on("keyup",A),p.find(".b5").on("touchstart",w),r.find(".next").on("touchstart",_),r.find(".prev").on("touchstart",j),h.find(".b6").on("touchstart",y),h.find(".b7").on("touchstart",x),h.find(".prev").on("touchstart",G),c.find(".b8").on("touchstart",T),s.on("change",b),d.on("submit",P)};$(l)}();